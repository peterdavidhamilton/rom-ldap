# Active Directory
# [
#   "1.2.840.113556.1.4.1338",
#   "1.2.840.113556.1.4.1339",
#   "1.2.840.113556.1.4.1340",
#   "1.2.840.113556.1.4.1341",
#   "1.2.840.113556.1.4.1413",
#   "1.2.840.113556.1.4.1504",
#   "1.2.840.113556.1.4.1852",
#   "1.2.840.113556.1.4.1907",
#   "1.2.840.113556.1.4.1948",
#   "1.2.840.113556.1.4.1974",
#   "1.2.840.113556.1.4.2026",
#   "1.2.840.113556.1.4.2064",
#   "1.2.840.113556.1.4.2065",
#   "1.2.840.113556.1.4.2066",
#   "1.2.840.113556.1.4.2090",
#   "1.2.840.113556.1.4.2204",
#   "1.2.840.113556.1.4.2205",
#   "1.2.840.113556.1.4.2206",
#   "1.2.840.113556.1.4.2211",
#   "1.2.840.113556.1.4.2239",
#   "1.2.840.113556.1.4.2255",
#   "1.2.840.113556.1.4.2256",
#   "1.2.840.113556.1.4.319",
#   "1.2.840.113556.1.4.417",
#   "1.2.840.113556.1.4.473",
#   "1.2.840.113556.1.4.474",
#   "1.2.840.113556.1.4.521",
#   "1.2.840.113556.1.4.528",
#   "1.2.840.113556.1.4.529",
#   "1.2.840.113556.1.4.619",
#   "1.2.840.113556.1.4.801",
#   "1.2.840.113556.1.4.802",
#   "1.2.840.113556.1.4.805",
#   "1.2.840.113556.1.4.841",
#   "1.2.840.113556.1.4.970",
#   "2.16.840.1.113730.3.4.10",
#   "2.16.840.1.113730.3.4.9"
# ]


# Apache DS
# [
#   "1.2.840.113556.1.4.1413",
#   "1.2.840.113556.1.4.319",
#   "1.2.840.113556.1.4.417",
#   "1.2.840.113556.1.4.473",
#   "1.2.840.113556.1.4.474",
#   "1.2.840.113556.1.4.528",
#   "1.2.840.113556.1.4.841",
#   "1.3.6.1.4.1.18060.0.0.1",
#   "1.3.6.1.4.1.42.2.27.8.5.1",
#   "1.3.6.1.4.1.4203.1.10.1",
#   "1.3.6.1.4.1.4203.1.9.1.1",
#   "1.3.6.1.4.1.4203.1.9.1.2",
#   "1.3.6.1.4.1.4203.1.9.1.3",
#   "1.3.6.1.4.1.4203.1.9.1.4",
#   "2.16.840.1.113730.3.4.10",
#   "2.16.840.1.113730.3.4.18",
#   "2.16.840.1.113730.3.4.2",
#   "2.16.840.1.113730.3.4.3",
#   "2.16.840.1.113730.3.4.7",
#   "2.16.840.1.113730.3.4.9"
# ]

module ROM
  module LDAP
    class Directory
      module Capabilities
        private

        # @return [Boolean]
        #
        # @api private
        def sortable?
          supported_controls.include?(SORT_RESPONSE)
        end

        # @return [Boolean]
        #
        # @api private
        def pageable?
          supported_controls.include?(PAGED_RESULTS)
        end

        # @return [Boolean]
        #
        # @api private
        def chainable?
          supported_controls.include?(MATCHING_RULE_IN_CHAIN)
        end

        # @return [Boolean]
        #
        # @api private
        def pruneable?
          supported_controls.include?(DELETE_TREE)
        end

        # @return [Boolean]
        #
        # @api private
        def bitwise?
          supported_controls.include?(MATCHING_RULE_BIT_AND) &&
            supported_controls.include?(MATCHING_RULE_BIT_OR)
        end

        # @return [Boolean]
        #
        # @api private
        def i18n?
          supported_controls.include?(LANGUAGE_TAG_OPTIONS) &&
            supported_controls.include?(LANGUAGE_RANGE_OPTIONS)
        end
      end
    end
  end
end
