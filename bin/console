#!/usr/bin/env ruby
#
#
#
require 'bundler/setup'

require 'rom/ldap'
ROM::LDAP.load_extensions :compatibility

module Sandbox
  module_function

  def conf
    ROM::Configuration.new(:ldap) do |conf|
      conf.relation(:all) do
        schema('(objectClass=*)', infer: true)
      end
    end
  end

  def container
    ROM.container(conf)
  end

  def sandbox
    container.relations[:all]
  end
end

include Sandbox

require 'pry'
Pry.start

# List every distinguished name
# sandbox.map(:dn).to_a
